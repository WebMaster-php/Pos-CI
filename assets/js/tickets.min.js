function insert_ticket_knowledgebase_link(e){
	var t=$(e).val();
	""!=t&&requestGetJSON("knowledge_base/get_article_by_id_ajax/"+t).done(function(t){$('textarea[name="message"]');
	tinymce.activeEditor.execCommand("mceInsertContent",!1,t.description),$(e).selectpicker("val","")})}
	function tickets_bulk_action(e){
		if(confirm_delete()){
			var t=$("#mass_delete").prop("checked"),a=[],n={};
				if(0==t||void 0===t){
					if(n.status=$("#move_to_status_tickets_bulk").val(),n.department=$("#move_to_department_tickets_bulk").val(),n.priority=$("#move_to_priority_tickets_bulk").val(),n.service=$("#move_to_service_tickets_bulk").val(),n.tags=$("#tags_bulk").tagit("assignedTags"),""==n.status&&""==n.department&&""==n.priority&&""==n.service&&""==n.tags)return}else n.mass_delete=!0;var i=$(".table-tickets").find("tbody tr");$.each(i,function(){var e=$($(this).find("td").eq(0)).find("input");1==e.prop("checked")&&a.push(e.val())}),n.ids=a,$(e).addClass("disabled"),setTimeout(function(){$.post(admin_url+"tickets/bulk_action",n).done(function(){window.location.reload()})},50)}}$(function(){$("#insert_predefined_reply").on("change",function(e){e.preventDefault();var t=$(this),a=t.val();""!=a&&requestGetJSON("tickets/get_predefined_reply_ajax/"+a).done(function(e){tinymce.activeEditor.execCommand("mceInsertContent",!1,e.message),t.selectpicker("val","")})}),$(".block-sender").on("click",function(){var e=$(this).data("sender");if(""==e)return alert("No Sender Found"),!1;$.post(admin_url+"tickets/block_sender",{sender:e}).done(function(){window.location.reload()})}),$(".add_note_ticket").on("click",function(e){e.preventDefault();var t=$('textarea[name="note_description"]').val(),a=$('input[name="ticketid"]').val();""!=t&&$.post(admin_url+"misc/add_note/"+a+"/ticket",{description:t}).done(function(){window.location.reload()})}),$(".save_changes_settings_single_ticket").on("click",function(e){e.preventDefault();var t={},a=$("#settings"),n=!1;""==a.find('input[name="subject"]').val()?(n=!0,a.find('input[name="subject"]').parents(".form-group").addClass("has-error")):a.find('input[name="subject"]').parents(".form-group").removeClass("has-error");for(var i=["department","priority","contactid"],s=0;s<i.length;s++){var r=a.find('select[name="'+i[s]+'"]');""==r.selectpicker("val")?(n=!0,r.parents(".form-group").addClass("has-error")):r.parents(".form-group").removeClass("has-error")}var o=a.find('[data-custom-field-required="1"]');$.each(o,function(){var e=$(this),t=e.parents(".form-group");e.is(":checkbox")?0==t.find('input[type="checkbox"]:checked').length?(n=!0,t.addClass("has-error")):t.removeClass("has-error"):e.is("input")||e.is("textarea")?""===e.val()?(n=!0,t.addClass("has-error")):t.removeClass("has-error"):e.is("select")&&(""==e.selectpicker("val")?(n=!0,t.addClass("has-error")):t.removeClass("has-error"))}),1!=n&&(t=$("#settings *").serialize(),t+="&ticketid="+$('input[name="ticketid"]').val(),"undefined"!=typeof csrfData&&(t+="&"+csrfData.token_name+"="+csrfData.hash),$.post(admin_url+"tickets/update_single_ticket_settings",t).done(function(e){1==(e=JSON.parse(e)).success&&(void 0!==e.department_reassigned?window.location.href=admin_url+"tickets/":window.location.reload())}))}),$("#new_ticket_form").submit(function(){return $("#project_id").prop("disabled",!1),!0}),$('select[name="status_top"]').on("change",function(){var e=$(this).val(),t=$('input[name="ticketid"]').val(), c = $("#client_customer_id").val();requestGetJSON("tickets/change_status_ajax/"+t+"/"+e+"/"+c).done(function(e){alert_float(e.alert,e.message)})}),$('body.ticket select[name="contactid"]').on("change",function(){var e=$(this).val(),t=$('select[name="project_id"]'),a=t.attr("data-auto-project"),n=$(".projects-wrapper");if(!t.attr("disabled")){var i;a?(i=t.clone()).prop("disabled",!0):i=t.html("").clone(),t.selectpicker("destroy").remove(),t=i,$("#project_ajax_search_wrapper").append(i),init_ajax_search("project",t,{customer_id:function(){return $('input[name="userid"]').val()}})}""!=e?$.post(admin_url+"tickets/ticket_change_data/",{contact_id:e}).done(function(e){(e=JSON.parse(e)).contact_data&&($('input[name="to"]').val(e.contact_data.firstname+" "+e.contact_data.lastname),$('input[name="email"]').val(e.contact_data.email),$('input[name="userid"]').val(e.contact_data.userid)),a?n.removeClass("hide"):e.customer_has_projects?n.removeClass("hide"):n.addClass("hide")}):($('input[name="to"]').val(""),$('input[name="email"]').val(""),$('input[name="contactid"]').val(""),a?n.removeClass("hide"):n.addClass("hide"))})});